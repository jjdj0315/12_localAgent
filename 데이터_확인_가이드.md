# 데이터 확인 가이드

## 1. Docker 볼륨 위치 확인

```bash
# 모든 볼륨 목록 확인
docker volume ls

# 특정 볼륨의 상세 정보 (실제 저장 위치 포함)
docker volume inspect 12_localagent_postgres_data
docker volume inspect 12_localagent_uploads_data
docker volume inspect 12_localagent_ollama_data
```

## 2. PostgreSQL 데이터베이스 확인

### 방법 1: 데이터베이스 직접 접속
```bash
# PostgreSQL 컨테이너 접속
docker exec -it llm-webapp-postgres psql -U llm_app -d llm_webapp

# SQL 명령어 실행 예시:
\dt                           # 테이블 목록 확인
SELECT * FROM users;          # 사용자 목록 확인
SELECT * FROM conversations;  # 대화 목록 확인
SELECT * FROM documents;      # 문서 목록 확인
\q                            # 종료
```

### 방법 2: 백엔드 컨테이너에서 확인
```bash
# 백엔드 컨테이너 접속
docker exec -it llm-webapp-backend sh

# Python으로 데이터베이스 조회
python
>>> from app.core.database import SessionLocal
>>> from app.models.user import User
>>> db = SessionLocal()
>>> users = db.query(User).all()
>>> for user in users:
...     print(f"Username: {user.username}, Role: {user.role}")
>>> exit()
```

## 3. 업로드된 파일 확인

### 백엔드 컨테이너 내부 파일 확인
```bash
# 백엔드 컨테이너 접속
docker exec -it llm-webapp-backend sh

# 업로드 디렉토리 확인
ls -lah /uploads/

# 특정 사용자 폴더 확인 (사용자 ID별로 저장됨)
ls -lah /uploads/user_1/
ls -lah /uploads/user_2/

# 파일 내용 확인 (텍스트 파일인 경우)
cat /uploads/user_1/sample.txt

exit
```

### 호스트에서 파일 복사하기
```bash
# 컨테이너에서 호스트로 파일 복사
docker cp llm-webapp-backend:/uploads/ ./local_uploads/

# 복사된 파일 확인
dir local_uploads
```

## 4. Ollama 모델 데이터 확인

```bash
# Ollama 컨테이너 접속
docker exec -it llm-webapp-ollama sh

# 다운로드된 모델 목록 확인
ls -lah /root/.ollama/models/

# Ollama API로 모델 확인
curl http://localhost:11434/api/tags

exit
```

## 5. 볼륨 데이터 백업

### PostgreSQL 백업
```bash
# 데이터베이스 덤프 생성
docker exec llm-webapp-postgres pg_dump -U llm_app llm_webapp > backup_$(date +%Y%m%d).sql

# 복원
docker exec -i llm-webapp-postgres psql -U llm_app llm_webapp < backup_20250126.sql
```

### 업로드 파일 백업
```bash
# 전체 uploads 디렉토리 백업
docker cp llm-webapp-backend:/uploads/ ./backup_uploads_$(date +%Y%m%d)/
```

## 6. 실시간 로그 확인

```bash
# 백엔드 로그 실시간 확인
docker logs -f llm-webapp-backend

# PostgreSQL 로그 확인
docker logs -f llm-webapp-postgres

# Ollama 로그 확인
docker logs -f llm-webapp-ollama
```

## 7. 디스크 사용량 확인

```bash
# 모든 볼륨의 크기 확인
docker system df -v

# 특정 컨테이너의 디스크 사용량
docker exec llm-webapp-backend du -sh /uploads/
```

## 주의사항

- Docker 볼륨 데이터는 Windows의 경우 `\\wsl$\docker-desktop-data\data\docker\volumes\` 경로에 저장됩니다
- 직접 볼륨 파일을 수정하면 데이터가 손상될 수 있으니 주의하세요
- 백업을 정기적으로 수행하는 것을 권장합니다
